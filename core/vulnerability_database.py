# core/vulnerability_database.py
from typing import Union, List
from pathlib import Path


class VulnerabilityDatabase:

    def __init__(self, path: Union[Path, str]):
        self._devices: List[str] = self._load(path)

    @staticmethod
    def _load(path: Union[str, Path], encoding: Union[str, None] = None) -> List[str]:
        if isinstance(path, str):
            path: Path = Path(path)

        if not path.exists():
            raise FileNotFoundError(f"File not found: {path}")

        with path.open(mode="r", encoding=encoding) as f:
            return f.read().splitlines()

    def is_vulnerable(self, device: str) -> bool:
        return device in self._devices
