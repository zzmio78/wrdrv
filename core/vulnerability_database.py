from typing import Union, Set, List
from pathlib import Path


class VulnerabilityDatabase:

    def __init__(self, path: Union[Path, str]):
        self._devices: Set[str] = set(self._load(path))

    @staticmethod
    def _load(path: Union[str, Path], encoding: str | None = None) -> Set[str]:
        path = Path(path)

        if not path.exists():
            raise FileNotFoundError(f"File not found: {path}")

        with path.open(mode="r", encoding=encoding) as f:
            return set(f.read().splitlines())

    def is_vulnerable(self, device: str) -> bool:
        return device in self._devices
